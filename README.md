# 字符串相似度比对工具

一个纯前端、开箱即用的字符串相似度比对小工具。支持两列文本比对、字符级差异高亮、前 5 个候选展示、同义词组替换、进度可视化、结果导出与设置持久化。

## 功能概览

- 比对模式：源列 vs 目标列，一对多匹配
- 算法融合：编辑距离相似度 + Jaro‑Winkler，按权重合成（默认 0.6 / 0.4）
- 字符级差异高亮：LCS/Levenshtein/Myers 三种实现，界面默认使用 LCS，高亮新增/删除/未变
- 同义词组：在比对前将同组词替换为第一项代表词，提升召回并减少形态差异干扰
- 候选展示：为每个源项列出按相似度排序的前 5 个候选
- 一键锁定：相似度达到 100% 自动锁定；支持手动锁定/解除和临时选择
- 进度反馈：进度条 + 当前处理项提示，长列表也有清晰反馈
- 导出结果：导出完整/简化 CSV；设置保存/加载（localStorage）
- 示例数据：一键加载示例，便于快速体验

## 快速开始

1) 直接用浏览器打开 `index.html`
2) 在“源列/目标列”粘贴待比对文本（每行一条，支持从 Excel 粘贴）
3) 按需勾选预处理与阈值等设置
4) 可填写“同义词组”（见下文格式说明）
5) 点击“开始比对”，观察进度与结果；需要时可“停止比对”
6) 根据需要导出 CSV 或保存设置

## 使用说明

- 输入
  - 源列：每行一个待匹配文本
  - 目标列：每行一个候选文本
- 预处理开关
  - 忽略标点：去除非字母数字和中文字符
  - 全角转半角：数字/字母/常见符号统一为半角
  - 忽略不可见字符：移除控制字符、零宽空格等
  - 整串对比模式：选项预留，当前算法按整体字符串计算
  - 相似度阈值：0–100%，只显示不低于阈值的候选
- 同义词组格式（多组用换行/分号/顿号分隔；同组内用逗号/空格分隔）
  - 例：
    - `阿里巴巴, 阿里`
    - `腾讯控股, 腾讯`
  - 同组第 1 个词为代表词；比对前会把同组其它词替换为代表词
- 交互
  - 点击候选可设为临时选择；点击最佳匹配区域可清除临时选择
  - 点击“锁定”可将当前最佳/临时选择固化；100% 自动锁定

## 结果与导出

- 结果表包含：源文本、最佳匹配（含字符级差异高亮）、相似度、其它候选（前 3–5 个）与锁定按钮
- 相似度颜色分级
  - exact：100%
  - similar：≥ 80%
  - medium：≥ 50%
  - low：< 50%
- CSV 导出字段
  - 完整：`源文本, 最佳匹配, 相似度, 锁定状态`
  - 简化：`源文本, 最佳匹配, 锁定状态`

## 算法说明（概要）

1) 预处理：统一大小写/空白，移除标点与不可见字符，可选全角转半角
2) 同义词：把同组词替换为代表词；若替换后两串完全一致，直接判为 1.0（100%）
3) 相似度：
   - 编辑距离相似度 = 1 − LevenshteinDistance / max(len1, len2)
   - Jaro‑Winkler 相似度：对前缀一致性加权
   - 融合：`edit * 0.6 + jaro * 0.4`（可在代码中调整权重）
4) 差异高亮：默认基于 LCS 生成逐字符的新增/删除/未变序列并着色

## 文件结构

```
index.html       # 页面结构与文案
styles.css       # 样式与配色（含差异高亮样式）
similarity.js    # 相似度计算与差异算法（核心逻辑）
app.js           # 应用状态、事件绑定、结果渲染、导出/存储
README.md        # 项目说明文档（本文件）
```

## 开发与扩展

- 主类
  - `SimilarityCalculator`（similarity.js）：预处理、同义词替换、相似度计算、差异算法
  - `SimilarityApp`（app.js）：数据与 UI 管理、进度与锁定、导出/存取
- 扩展点
  - 调整融合权重：在 `app.js` 组装的 `options.weights` 或 `similarity.js` 默认值
  - 差异算法：`calculateCharDiff(str1, str2, algorithm)` 已实现 `lcs/levenshtein/myers`
  - 性能：当前用 `setTimeout` 分片防阻塞；如需更大规模可改为 Web Worker
- 持久化
  - 设置保存在 `localStorage/similarityAppData`

## 注意事项

1) 浏览器直接打开即可，无需后端服务；建议使用现代浏览器
2) 设置仅保存到本地浏览器；清理浏览数据会丢失设置
3) 阈值越高筛选越严格，只影响候选显示，不改变计算结果
4) 若看到中文显示为乱码，请确认文件与浏览器均为 UTF‑8 编码（页面已设置 `<meta charset="UTF-8">`）

## 变更记录（摘）

- 新增：100% 自动锁定
- 新增：字符级差异高亮（新增/删除/未变）
- 新增：导出完整/简化结果，保存/加载设置
- 新增：同义词组替换与示例数据

—— 如果你调整了功能需求或字段，我可以同步更新实现和文档；告诉我你改了什么即可。

